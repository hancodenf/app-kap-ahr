import{r as c,u as Z,j as e,H as ee,L as se}from"./app-P5z6obs2.js";import{A as te}from"./AuthenticatedLayout-D0YHYUQl.js";import"./ApplicationLogo-DVGoP-gl.js";function ie({auth:le,project:b,workingSteps:R}){const[M,I]=c.useState([]),[r,y]=c.useState(null),[_,N]=c.useState(!1),[z,v]=c.useState(!1),[D,C]=c.useState([]),[d,f]=c.useState("upload"),[u,m]=c.useState([{id:0,label:"",file:null}]),[h,x]=c.useState([{id:0,name:"",description:""}]),[w,p]=c.useState(1),[k,g]=c.useState(1);c.useEffect(()=>(_?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[_]);const{data:B,setData:a,post:V,processing:A,errors:j,reset:L}=Z({notes:"",files:[],file_labels:[],upload_mode:"upload",client_documents:[],task_status:"Draft"}),q=s=>{I(l=>l.includes(s)?l.filter(t=>t!==s):[...l,s])},T=(s,l)=>{l.can_access&&s.is_assigned_to_me&&(y(s),v(!0),s.assignments&&s.assignments.length>0?C([s.assignments[0].id]):C([]),f("upload"),m([{id:0,label:"",file:null}]),x([{id:0,name:"",description:""}]),p(1),g(1),a({notes:s.latest_assignment?.notes||"",files:[],upload_mode:"upload",client_documents:[],task_status:s.status}),N(!0))},W=s=>{C(l=>l.includes(s)?l.filter(t=>t!==s):[...l,s])},P=(s,l)=>{const t=u.map(n=>n.id===s?{...n,label:l}:n);m(t);const i=t.filter(n=>n.file!==null).map(n=>n.label||"");a("file_labels",i)},F=(s,l)=>{const t=u.map(o=>o.id===s?{...o,file:l}:o);m(t);const i=t.filter(o=>o.file!==null).map(o=>o.file),n=t.filter(o=>o.file!==null).map(o=>o.label||"");a("files",i),a("file_labels",n)},H=(s,l)=>{l.preventDefault(),l.stopPropagation();const t=l.dataTransfer.files?.[0];t&&F(s,t)},U=(s,l)=>{const t=l.target.files?.[0];t&&F(s,t)},$=()=>{r&&!r.multiple_files&&u.length>=1||(m([...u,{id:w,label:"",file:null}]),p(w+1))},X=s=>{if(u.length===1)m([{id:w,label:"",file:null}]),p(w+1),a("files",[]),a("file_labels",[]);else{const l=u.filter(n=>n.id!==s);m(l);const t=l.filter(n=>n.file!==null).map(n=>n.file),i=l.filter(n=>n.file!==null).map(n=>n.label||"");a("files",t),a("file_labels",i)}},E=(s,l)=>{const t=h.map(i=>i.id===s?{...i,name:l}:i);x(t),S(t)},O=(s,l)=>{const t=h.map(i=>i.id===s?{...i,description:l}:i);x(t),S(t)},S=s=>{const l=s.filter(t=>t.name.trim()!=="");a("client_documents",l.map(({name:t,description:i})=>({name:t,description:i})))},G=()=>{r&&!r.multiple_files&&h.length>=1||(x([...h,{id:k,name:"",description:""}]),g(k+1))},K=s=>{if(h.length===1)x([{id:k,name:"",description:""}]),g(k+1),a("client_documents",[]);else{const l=h.filter(t=>t.id!==s);x(l),S(l)}},J=s=>{s.preventDefault(),r&&(a("upload_mode",d),d==="upload"?a("client_documents",[]):a("files",[]),setTimeout(()=>{V(route("admin.tasks.update-status",r.id),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{N(!1),y(null),v(!1),f("upload"),m([{id:0,label:"",file:null}]),x([{id:0,name:"",description:""}]),p(1),g(1),L()}})},0))},Q=s=>{switch(s){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},Y=s=>{switch(s){case"completed":return e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"in_progress":return e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})});default:return e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})}};return e.jsxs(te,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(se,{href:route("admin.projects.bundles.index"),className:"text-sm text-gray-500 hover:text-gray-700 mb-1 inline-block",children:"â† Back to Projects"}),e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:b.name}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Client: ",b.client_name," â€¢ Role: Admin (Full Access)"]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${b.status==="open"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:b.status})]}),children:[e.jsx(ee,{title:b.name}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:R.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No working steps in this project yet."})}):e.jsx("div",{className:"space-y-4",children:R.map((s,l)=>e.jsxs("div",{className:`border rounded-lg ${s.is_locked&&!s.can_access?"border-gray-300 bg-gray-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:`p-4 flex items-center justify-between cursor-pointer ${s.is_locked&&!s.can_access?"opacity-60":""}`,onClick:()=>q(s.id),children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary-100 text-primary-700 font-semibold text-sm",children:l+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.name,s.is_locked&&!s.can_access&&e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),!s.is_locked&&e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v5a2 2 0 002 2h10a2 2 0 002-2v-5a2 2 0 00-2-2H7V7a3 3 0 015.905-.75 1 1 0 001.937-.5A5.002 5.002 0 0010 2z"})})]}),s.is_locked&&!s.can_access&&s.required_progress&&e.jsxs("div",{className:"mt-1",children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"ðŸ”’ Locked - Complete required tasks in previous step"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-500 h-2 rounded-full transition-all",style:{width:`${s.required_progress.percentage}%`}})}),e.jsxs("span",{className:"text-xs text-gray-600 min-w-[60px]",children:[s.required_progress.completed,"/",s.required_progress.total," tasks"]})]})]})]})]}),e.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${M.includes(s.id)?"transform rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),M.includes(s.id)&&e.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:s.tasks.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No tasks in this step."}):e.jsx("div",{className:"space-y-2",children:s.tasks.map(t=>e.jsx("div",{onClick:()=>T(t,s),className:`p-4 rounded-lg border ${t.is_assigned_to_me&&s.can_access?"bg-white border-gray-200 hover:border-primary-300 hover:shadow-sm cursor-pointer":"bg-gray-100 border-gray-200 cursor-not-allowed"} transition-all`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Y(t.completion_status),e.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),t.is_required&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Required"]}),!t.is_assigned_to_me&&e.jsx("span",{className:"text-xs text-gray-500 italic",children:"(Not assigned to you)"})]}),t.latest_assignment?.comment&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["ðŸ’¬ ",t.latest_assignment.comment]}),t.latest_assignment?.time&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["â±ï¸ ",new Date(t.latest_assignment.time).toLocaleDateString("id-ID")]})]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Q(t.completion_status)}`,children:t.completion_status.replace("_"," ")})]})},t.id))})})]},s.id))})})})})}),_&&r&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full my-8 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white pt-6 pb-4 border-b border-gray-200 px-6 z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Update Task: ",r.name]}),e.jsx("button",{type:"button",onClick:()=>{N(!1),y(null),v(!1),f("upload"),m([{id:0,label:"",file:null}]),x([{id:0,name:"",description:""}]),p(1),g(1),L()},className:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 rounded-lg p-1.5 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"px-6 pb-6",children:z?e.jsxs("form",{onSubmit:J,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Task Status",e.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(Admin can change status)"})]}),e.jsxs("select",{value:B.task_status,onChange:s=>a("task_status",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{value:"Draft",children:"Draft"}),e.jsx("option",{value:"Submitted",children:"Submitted"}),e.jsx("option",{value:"Submitted to Client",children:"Submitted to Client"}),e.jsx("option",{value:"Client Reply",children:"Client Reply"}),e.jsx("option",{value:"Under Review by Team Leader",children:"Under Review by Team Leader"}),e.jsx("option",{value:"Approved by Team Leader",children:"Approved by Team Leader"}),e.jsx("option",{value:"Returned for Revision (by Team Leader)",children:"Returned for Revision (by Team Leader)"}),e.jsx("option",{value:"Under Review by Manager",children:"Under Review by Manager"}),e.jsx("option",{value:"Approved by Manager",children:"Approved by Manager"}),e.jsx("option",{value:"Returned for Revision (by Manager)",children:"Returned for Revision (by Manager)"}),e.jsx("option",{value:"Under Review by Supervisor",children:"Under Review by Supervisor"}),e.jsx("option",{value:"Approved by Supervisor",children:"Approved by Supervisor"}),e.jsx("option",{value:"Returned for Revision (by Supervisor)",children:"Returned for Revision (by Supervisor)"}),e.jsx("option",{value:"Under Review by Partner",children:"Under Review by Partner"}),e.jsx("option",{value:"Approved by Partner",children:"Approved by Partner"}),e.jsx("option",{value:"Returned for Revision (by Partner)",children:"Returned for Revision (by Partner)"})]}),j.task_status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.task_status})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Notes",e.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(Your submission notes)"})]}),e.jsx("textarea",{value:B.notes,onChange:s=>a("notes",s.target.value),rows:3,placeholder:"Add your notes here...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500"}),j.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.notes})]}),r.assignments&&r.assignments.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Submission History (",r.assignments.length," submission",r.assignments.length>1?"s":"",")"]}),e.jsx("div",{className:"space-y-4",children:r.assignments.map((s,l)=>e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Submission #",r.assignments.length-l,l===0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Latest"}),s.is_approved&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded-full",children:"Approved"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),s.notes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"ðŸ“ Notes:"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.notes})]}),s.comment&&e.jsxs("div",{className:"mb-3 p-2 bg-red-50 border-l-4 border-red-400 rounded",children:[e.jsx("p",{className:"text-xs font-medium text-red-800",children:"âŒ Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-900 mt-1",children:s.comment})]}),s.client_comment&&e.jsxs("div",{className:"mb-3 p-2 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:[e.jsx("p",{className:"text-xs font-medium text-yellow-800",children:"ðŸ’¬ Client Reply:"}),e.jsx("p",{className:"text-sm text-yellow-900 mt-1",children:s.client_comment})]}),s.documents&&s.documents.length>0&&e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-700",children:["ðŸ“Ž Uploaded Documents (",s.documents.length,"):"]}),s.documents.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white border border-gray-200 rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"text-sm text-gray-900",children:t.name})]}),e.jsxs("a",{href:`/storage/${t.file}`,download:!0,className:"inline-flex items-center px-2 py-1 text-xs font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})]},t.id))]}),s.client_documents&&s.client_documents.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-700",children:["ðŸ“‹ Document Requests for Client (",s.client_documents.length,"):"]}),s.client_documents.map(t=>e.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-purple-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name}),t.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:t.description}),t.file?e.jsx("div",{className:"mt-2",children:e.jsxs("a",{href:`/storage/${t.file}`,download:!0,className:"inline-flex items-center px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded hover:bg-green-200",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"âœ“ Uploaded by Client"]})}):e.jsx("p",{className:"text-xs text-purple-700 mt-2 italic",children:"â³ Waiting for client upload..."})]})]})},t.id))]})]},s.id))})]}),e.jsxs("div",{children:[r.client_interact&&e.jsx("div",{className:"mb-4 border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[e.jsxs("button",{type:"button",onClick:()=>{f("upload"),x([{id:0,name:"",description:""}]),g(1),a("client_documents",[]),a("upload_mode","upload")},className:`${d==="upload"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:[e.jsx("svg",{className:"w-5 h-5 inline-block mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload Files"]}),e.jsxs("button",{type:"button",onClick:()=>{f("request"),m([{id:0,label:"",file:null}]),p(1),a("files",[]),a("upload_mode","request")},className:`${d==="request"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:[e.jsx("svg",{className:"w-5 h-5 inline-block mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Request from Client"]})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[d==="upload"?"Upload Files":"Request Documents from Client",r.multiple_files?e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(Multiple ",d==="upload"?"files":"documents"," allowed)"]}):e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(Single ",d==="upload"?"file":"document"," only)"]})]}),r.multiple_files&&e.jsxs("button",{type:"button",onClick:d==="upload"?$:G,className:"inline-flex items-center px-3 py-1 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add ",d==="upload"?"File":"Document"]})]}),d==="upload"&&e.jsxs("div",{className:"space-y-4",children:[u.map((s,l)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"File Label / Name"}),e.jsx("input",{type:"text",value:s.label,onChange:t=>P(s.id,t.target.value),placeholder:"e.g., Laporan Keuangan, KTP, etc.",className:"block w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500"})]}),e.jsx("button",{type:"button",onClick:()=>X(s.id),className:"mt-6 p-1.5 text-red-600 hover:text-red-700 hover:bg-red-100 rounded-md transition-colors",title:"Remove file input",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"File Upload"}),e.jsxs("div",{onDrop:t=>H(s.id,t),onDragOver:t=>t.preventDefault(),onDragEnter:t=>t.preventDefault(),className:"relative border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-primary-400 hover:bg-white transition-colors cursor-pointer",children:[s.file?e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-green-600",children:[e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.file.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.file.size/1024).toFixed(2)," KB"]})]})]}):e.jsxs("div",{children:[e.jsx("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-primary-600",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF, DOC, DOCX, XLS, XLSX, JPG, PNG (Max. 10MB)"})]}),e.jsx("input",{type:"file",onChange:t=>U(s.id,t),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png"})]})]})]},s.id)),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Allowed: PDF, DOC, DOCX, XLS, XLSX, JPG, JPEG, PNG (Max. 10MB per file)"}),j.files&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.files})]}),d==="request"&&e.jsxs("div",{className:"space-y-4",children:[h.map((s,l)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Document Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:s.name,onChange:t=>E(s.id,t.target.value),placeholder:"e.g., Laporan Keuangan Q4, Surat Pernyataan",className:"block w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500",required:!0})]}),e.jsx("button",{type:"button",onClick:()=>K(s.id),className:"mt-6 p-1.5 text-red-600 hover:text-red-700 hover:bg-red-100 rounded-md transition-colors",title:"Remove document request",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description / Notes (Optional)"}),e.jsx("textarea",{value:s.description,onChange:t=>O(s.id,t.target.value),rows:2,placeholder:"Additional details about this document request...",className:"block w-full text-sm border-gray-300 rounded-md shadow-sm focus:border-primary-500 focus:ring-primary-500"})]})]},s.id)),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"ðŸ’¡ These document requests will be sent to the client for upload."})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{N(!1),y(null),v(!1),f("upload"),m([{id:0,label:"",file:null}]),x([{id:0,name:"",description:""}]),p(1),g(1),L()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:A,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 disabled:opacity-50",children:A?"Saving...":"Save Changes"})]})]}):e.jsx("div",{className:"space-y-4",children:r.assignments&&r.assignments.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:["Submission History (",r.assignments.length," submission",r.assignments.length>1?"s":"",")"]}),e.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:r.assignments.map((s,l)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:[e.jsx("div",{className:"p-4 bg-gray-50 hover:bg-gray-100 cursor-pointer transition-colors",onClick:()=>W(s.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Submission #",r.assignments.length-l]}),l===0&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Latest"}),s.is_approved&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded-full",children:"âœ“ Approved"}),s.comment&&!s.is_approved&&e.jsx("span",{className:"px-2 py-0.5 text-xs bg-red-100 text-red-800 rounded-full",children:"âœ— Rejected"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${D.includes(s.id)?"transform rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),D.includes(s.id)&&e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-white space-y-3",children:[s.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"ðŸ“ Notes:"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.notes})]}),s.comment&&e.jsxs("div",{className:"p-2 bg-red-50 border-l-4 border-red-400 rounded",children:[e.jsx("p",{className:"text-xs font-medium text-red-800",children:"âŒ Rejection Reason:"}),e.jsx("p",{className:"text-sm text-red-900 mt-1",children:s.comment})]}),s.client_comment&&e.jsxs("div",{className:"p-2 bg-yellow-50 border-l-4 border-yellow-400 rounded",children:[e.jsx("p",{className:"text-xs font-medium text-yellow-800",children:"ðŸ’¬ Client Reply:"}),e.jsx("p",{className:"text-sm text-yellow-900 mt-1",children:s.client_comment})]}),s.documents&&s.documents.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-700",children:["ðŸ“ Uploaded Documents (",s.documents.length,"):"]}),s.documents.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"text-sm text-gray-900",children:t.name})]}),e.jsxs("a",{href:`/storage/${t.file}`,download:!0,className:"inline-flex items-center px-2 py-1 text-xs font-medium text-blue-600 hover:text-blue-800",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})]},t.id))]}),s.client_documents&&s.client_documents.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-700",children:["ðŸ“‹ Requested Documents (",s.client_documents.length,"):"]}),s.client_documents.map(t=>e.jsx("div",{className:"p-2 bg-purple-50 border border-purple-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-purple-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name}),t.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:t.description})]})]})},t.id))]})]})]},s.id))}),r.assignments.length>0&&r.assignments[0].comment&&!r.assignments[0].is_approved&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsxs("button",{type:"button",onClick:()=>v(!0),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-primary-600 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add New Submission"]})})]})})})]})})]})}export{ie as default};
