import{u as _,r as h,j as e,H as C,L as w}from"./app-DXo1r5rC.js";import{A as k}from"./AuthenticatedLayout-CODwulK2.js";import{S as c}from"./SearchableSelect-BI67RZUB.js";import"./ApplicationLogo-Chyc4ICs.js";function T({auth:M,clients:o,availableUsers:u,templates:b}){const n=new Date().getFullYear(),{data:s,setData:m,post:j,processing:x,errors:l}=_({name:"",client_id:0,year:n,team_members:[],template_id:0}),g=h.useMemo(()=>{const r=(o.find(a=>a.id===s.client_id)?.used_years||[]).map(a=>Number(a));return Array.from({length:n-1999},(a,i)=>{const d=n-i,N=r.includes(d);return{value:d,label:d.toString(),isDisabled:N}})},[s.client_id,o,n]);h.useEffect(()=>{const r=(o.find(a=>a.id===s.client_id)?.used_years||[]).map(a=>Number(a));if(r.includes(s.year)){const a=Array.from({length:n-1999},(i,d)=>n-d).find(i=>!r.includes(i));a&&m("year",a)}},[s.client_id]);const y=()=>{m("team_members",[...s.team_members,{user_id:0,role:"member"}])},p=(t,r,a)=>{const i=[...s.team_members];i[t]={...i[t],[r]:a},m("team_members",i)},v=t=>{m("team_members",s.team_members.filter((r,a)=>a!==t))},f=t=>{t.preventDefault(),j(route("admin.projects.bundles.store"))};return e.jsxs(k,{header:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Create New Project"})}),children:[e.jsx(C,{title:"Create New Project"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-2xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"New Project"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Create a new project"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:t=>m("name",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Project Audit ABC Company",required:!0}),l.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.name})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"client",className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(c,{options:o.map(t=>({value:t.id,label:t.name,subtitle:`${t.kementrian} - ${t.alamat}`})),value:s.client_id,onChange:t=>m("client_id",t),placeholder:"Select a client..."}),l.client_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.client_id})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Year ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(c,{options:g,value:s.year,onChange:t=>m("year",t),placeholder:"Select project year..."}),l.year&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.year})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team Members"}),e.jsxs("div",{className:"space-y-3",children:[s.team_members.map((t,r)=>e.jsxs("div",{className:"flex gap-3 items-start p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Select User"}),e.jsx(c,{options:u.map(a=>({value:a.id,label:a.name,subtitle:`${a.email}${a.position?" - "+a.position:""}`})),value:t.user_id,onChange:a=>p(r,"user_id",a),placeholder:"Select a user..."})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Role"}),e.jsxs("select",{value:t.role,onChange:a=>p(r,"role",a.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"team leader",children:"Team Leader"}),e.jsx("option",{value:"supervisor",children:"Supervisor"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"partner",children:"Partner"})]})]}),e.jsx("div",{className:"pt-6",children:e.jsx("button",{type:"button",onClick:()=>v(r),className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Remove member",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},r)),e.jsxs("button",{type:"button",onClick:y,className:"w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-primary-500 hover:text-primary-600 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Team Member"]})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Optional: Add team members with their roles in this project"}),l.team_members&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.team_members})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"template",className:"block text-sm font-medium text-gray-700 mb-2",children:"Copy from Template (Optional)"}),e.jsx(c,{options:[{value:0,label:"-- No Template --"},...b.map(t=>({value:t.id,label:t.name}))],value:s.template_id,onChange:t=>m("template_id",t),placeholder:"Choose a template..."}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Optional: If selected, working steps will be copied from the template"}),l.template_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.template_id})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx(w,{href:route("admin.projects.bundles.index"),className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,className:"bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50",children:x?"Creating...":"Create Project"})]})]})]})})})})]})}export{T as default};
